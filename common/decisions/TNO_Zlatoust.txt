UDM_Black_Market_Order_Received = {

	udm_black_market_buyer_infantry_equipment_fulfill = { #InfEq

		icon = GFX_decision_generic_prepare_civil_war

		available = {
			has_political_power > 4
			has_equipment = {
				infantry_equipment > 999
			}
		}

		target_trigger = {
			FROM = {
				exists = yes
				has_country_flag = udm_infantry_equipment_ordered
			}
		}

		fire_only_once = yes

		selectable_mission = yes
		days_mission_timeout = 30

		timeout_effect = {
			FROM = {
				if = {
					limit = {
						NOT = {
							has_country_flag = udm_black_market_deal_failed
						}
					}
					set_country_flag = udm_black_market_deal_failed
				}
				hidden_effect = {
					country_event = {
						id = zlatoust_sales.6
					}
					country_event = {
						id = zlatoust_sales.4
						days = 60
					}
				}
				clr_country_flag = udm_infantry_equipment_ordered
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_infantry_equipment_fulfill"

			send_equipment = {
				equipment = infantry_equipment
				amount = 1000
				target = FROM
			}

			UDM = {
				custom_effect_tooltip = gain_loot_1
				add_to_variable = { loot_amount = 1 }
			}

			FROM = {
				clr_country_flag = udm_infantry_equipment_ordered
				if = {
					limit = {
						is_warlord = yes
					}
					add_timed_idea = {
						idea = UDM_black_market_payments
						days = 30
					}
					hidden_effect = {
						country_event = {
							id = zlatoust_sales.7
							days = 1
						}
					}
				}
			}
		}

		cost = 5

		ai_will_do = {
			factor = 100
		}

	}

	udm_black_market_buyer_support_equipment_fulfill = { #SupEq

		icon = GFX_decision_generic_prepare_civil_war

		available = {
			has_political_power > 4
			has_equipment = {
				support_equipment_1 > 199
			}
		}

		allowed = {

			
			tag = UDM

		}

		visible = {
		}

		target_trigger = {
			FROM = {
				exists = yes
				has_country_flag = udm_support_equipment_ordered
			}
		}

		fire_only_once = yes

		selectable_mission = yes
		days_mission_timeout = 30

		timeout_effect = {
			FROM = {
				if = {
					limit = {
						NOT = {
							has_country_flag = udm_black_market_deal_failed
						}
					}
					set_country_flag = udm_black_market_deal_failed
				}
				hidden_effect = {
					country_event = {
						id = zlatoust_sales.6
					}
					country_event = {
						id = zlatoust_sales.4
						days = 60
					}
				}
				clr_country_flag = udm_support_equipment_ordered
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_support_equipment_fulfill"

			send_equipment = {
				equipment = support_equipment_1
				amount = 200
				target = FROM
			}

			UDM = {
				custom_effect_tooltip = gain_loot_1
				add_to_variable = { loot_amount = 1 }
			}

			FROM = {
				clr_country_flag = udm_support_equipment_ordered
				if = {
					limit = {
						is_warlord = yes
					}
					add_timed_idea = {
						idea = UDM_black_market_payments
						days = 30
					}
					hidden_effect = {
						country_event = {
							id = zlatoust_sales.7
							days = 1
						}
					}
				}
			}
		}

		cost = 5

		ai_will_do = {
			factor = 100
		}

	}

	udm_black_market_buyer_anti_tank_equipment_fulfill = { #AntiTankEq

		icon = GFX_decision_generic_prepare_civil_war

		available = {
			has_political_power > 4
			has_equipment = {
				anti_tank_equipment > 249
			}
		}

		allowed = {

			
			tag = UDM

		}

		visible = {
		}

		target_trigger = {
			FROM = {
				exists = yes
				has_country_flag = udm_anti_tank_equipment_ordered
			}
		}

		fire_only_once = yes

		selectable_mission = yes
		days_mission_timeout = 30

		timeout_effect = {
			FROM = {
				if = {
					limit = {
						NOT = {
							has_country_flag = udm_black_market_deal_failed
						}
					}
					set_country_flag = udm_black_market_deal_failed
				}
				hidden_effect = {
					country_event = {
						id = zlatoust_sales.6
					}
					country_event = {
						id = zlatoust_sales.4
						days = 60
					}
				}
				clr_country_flag = udm_anti_tank_equipment_ordered
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_anti_tank_equipment_fulfill"

			send_equipment = {
				equipment = anti_tank_equipment
				amount = 250
				target = FROM
			}

			UDM = {
				custom_effect_tooltip = gain_loot_2
				add_to_variable = { loot_amount = 2 }
			}

			FROM = {
				clr_country_flag = udm_anti_tank_equipment_ordered
				if = {
					limit = {
						is_warlord = yes
					}
					add_timed_idea = {
						idea = UDM_black_market_payments
						days = 30
					}
					hidden_effect = {
						country_event = {
							id = zlatoust_sales.7
							days = 1
						}
					}
				}
			}
		}

		cost = 5

		ai_will_do = {
			factor = 100
		}
	}

	udm_black_market_buyer_towed_artillery_equipment_fulfill = { #TowedArtEq

		icon = GFX_decision_generic_prepare_civil_war

		available = {
			has_political_power > 4
			has_equipment = {
				artillery_equipment > 99
			}
		}

		allowed = {

			
			tag = UDM

		}

		visible = {
		}

		target_trigger = {
			FROM = {
				exists = yes
				has_country_flag = udm_towed_artillery_equipment_ordered
			}
		}

		fire_only_once = yes

		selectable_mission = yes
		days_mission_timeout = 30

		timeout_effect = {
			FROM = {
				if = {
					limit = {
						NOT = {
							has_country_flag = udm_black_market_deal_failed
						}
					}
					set_country_flag = udm_black_market_deal_failed
				}
				hidden_effect = {
					country_event = {
						id = zlatoust_sales.6
					}
					country_event = {
						id = zlatoust_sales.4
						days = 60
					}
				}
				clr_country_flag = udm_towed_artillery_equipment_ordered
			}
		}

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_towed_artillery_equipment_fulfill"

			send_equipment = {
				equipment = artillery_equipment
				amount = 100
				target = FROM
			}

			UDM = {
				custom_effect_tooltip = gain_loot_2
				add_to_variable = { loot_amount = 2 }
			}

			FROM = {
				clr_country_flag = udm_towed_artillery_equipment_ordered
				if = {
					limit = {
						is_warlord = yes
					}
					add_timed_idea = {
						idea = UDM_black_market_payments
						days = 50
					}
					hidden_effect = {
						country_event = {
							id = zlatoust_sales.7
							days = 1
						}
					}
				}
			}
		}

		cost = 5

		ai_will_do = {
			factor = 100
		}

	}
}

UDM_Black_Market_Purchase_Foreign = {

	udm_black_market_buyer_infantry_equipment = {

		icon = decision_black_market_money

		available = {
			hidden_trigger = {
				has_country_flag = udm_sphere_of_influence
			}
			has_political_power > 9
			NOT = {
				OR = {
					has_country_flag = udm_black_market_deal_failed
					has_country_flag = udm_infantry_equipment_ordered
				}
				has_idea = UDM_black_market_payments
			}
			UDM = {
				has_equipment = {
					infantry_equipment > 999
				}
			}
		}

		visible = {
			has_country_flag = udm_sphere_of_influence
		}

		fire_only_once = no

		days_re_enable = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_infantry_equipment"
			set_country_flag = udm_infantry_equipment_ordered
		}

		cost = 10

		ai_will_do = {
			base = 0
			modifier = {
				add = 10
				stockpile_ratio = {
					archetype = infantry_equipment
					ratio > 0.1
				}
			}
			modifier = {
				add = 6
				stockpile_ratio = {
					archetype = infantry_equipment
					ratio > 0.2
				}
			}
			modifier = {
				add = 4
				stockpile_ratio = {
					archetype = infantry_equipment
					ratio > 0.3
				}
			}
			modifier = {
				add = 5
				OR = {
					has_war = yes
					has_civil_war = yes
				}
			}
		}

	}

	udm_black_market_buyer_support_equipment = {

		icon = decision_black_market_money

		available = {
			hidden_trigger = {
				has_country_flag = udm_sphere_of_influence
			}
			has_political_power > 9
			NOT = {
				OR = {
					has_country_flag = udm_black_market_deal_failed
					has_country_flag = udm_support_equipment_ordered
				}
				has_idea = UDM_black_market_payments
			}
			UDM = {
				has_equipment = {
					support_equipment_1 > 199
				}
			}
		}

		visible = {
			has_country_flag = udm_sphere_of_influence
		}

		fire_only_once = no

		days_re_enable = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_support_equipment"
			set_country_flag = udm_support_equipment_ordered
		}

		cost = 10

		ai_will_do = {
			base = 0
			modifier = {
				add = 10
				stockpile_ratio = {
					archetype = support_equipment
					ratio > 0.1
				}
			}
			modifier = {
				add = 6
				stockpile_ratio = {
					archetype = support_equipment
					ratio > 0.2
				}
			}
			modifier = {
				add = 4
				stockpile_ratio = {
					archetype = support_equipment
					ratio > 0.3
				}
			}
			modifier = {
				add = 5
				OR = {
					has_war = yes
					has_civil_war = yes
				}
			}
		}

	}

	udm_black_market_buyer_anti_tank_equipment = {

		icon = decision_black_market_money

		available = {
			hidden_trigger = {
				has_country_flag = udm_sphere_of_influence
			}
			has_political_power > 9
			NOT = {
				OR = {
					has_country_flag = udm_black_market_deal_failed
					has_country_flag = udm_anti_tank_equipment_ordered
				}
				has_idea = UDM_black_market_payments
			}
			UDM = {
				has_equipment = {
					anti_tank_equipment > 149
				}
			}
		}

		visible = {
			has_country_flag = udm_sphere_of_influence
		}

		fire_only_once = no

		days_re_enable = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_anti_tank_equipment"
			set_country_flag = udm_anti_tank_equipment_ordered
		}

		cost = 10

		ai_will_do = {
			base = 0
			modifier = {
				add = 10
				stockpile_ratio = {
					archetype = anti_tank_equipment
					ratio > 0.1
				}
			}
			modifier = {
				add = 6
				stockpile_ratio = {
					archetype = anti_tank_equipment
					ratio > 0.2
				}
			}
			modifier = {
				add = 4
				stockpile_ratio = {
					archetype = anti_tank_equipment
					ratio > 0.3
				}
			}
			modifier = {
				add = 5
				OR = {
					has_war = yes
					has_civil_war = yes
				}
			}
		}
	}

	udm_black_market_buyer_towed_artillery_equipment = {

		icon = decision_black_market_money

		available = {
			hidden_trigger = {
				has_country_flag = udm_sphere_of_influence
			}
			has_political_power > 9
			NOT = {
				OR = {
					has_country_flag = udm_black_market_deal_failed
					has_country_flag = udm_towed_artillery_equipment_ordered
				}
				has_idea = UDM_black_market_payments
			}
			UDM = {
				has_equipment = {
					artillery_equipment > 99
				}
			}
		}

		visible = {
			has_country_flag = udm_sphere_of_influence
		}

		fire_only_once = no

		days_re_enable = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision udm_black_market_buyer_towed_artillery_equipment"
			set_country_flag = udm_towed_artillery_equipment_ordered
		}

		cost = 10

		ai_will_do = {
			base = 0
			modifier = {
				add = 10
				stockpile_ratio = {
					archetype = artillery_equipment
					ratio > 0.1
				}
			}
			modifier = {
				add = 6
				stockpile_ratio = {
					archetype = artillery_equipment
					ratio > 0.2
				}
			}
			modifier = {
				add = 4
				stockpile_ratio = {
					archetype = artillery_equipment
					ratio > 0.3
				}
			}
			modifier = {
				add = 5
				OR = {
					has_war = yes
					has_civil_war = yes
				}
			}
		}

	}

	UDM_purchase_military_access = {
		icon = decision_black_market_money

		available = {
			hidden_trigger = {
				has_country_flag = udm_sphere_of_influence
			}
			has_political_power > 9
			NOT = {
				has_country_flag = udm_black_market_deal_failed
				has_idea = UDM_black_market_payments
			}
			NOT = {
				has_country_flag = UDM_GRANTED_MILITARY_ACCESS
			}
		}

		visible = {
			has_country_flag = udm_sphere_of_influence
			UDM = {
				has_country_flag = UDM_PAY_TO_PASS_FLAG
			}
			NOT = {
				has_country_flag = UDM_GRANTED_MILITARY_ACCESS
			}
		}

		fire_only_once = no

		days_re_enable = 90

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_purchase_military_access"
			UDM = {
				country_event = {
					id = zlatoust_sales.1
					days = 1
				}
			}
		}

		cost = 10

		ai_will_do = {
			base = 5
		}
	}
}

UDM_Expenditures = {
	UDM_hire_mercenary_brigades = {

		icon = decision_black_market_money


		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2

		visible = {
			has_country_flag = UDM_CAN_HIRE_MERCS
		}

		fire_only_once = no

		days_re_enable = 180

		days_remove = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_hire_mercenary_brigades"
			subtract_from_variable = { loot_amount = 2 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_hire_mercenary_brigades"
			custom_effect_tooltip = UDM_hire_mercenary_brigades_tt
			hidden_effect = {
				load_oob = UDM_mercs_infantry
			}

		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_hire_mercenary_motorized_brigades = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 2 }
		}

		custom_cost_text = decision_cost_loot_3

		visible = {
			has_country_flag = UDM_CAN_HIRE_MERCS
		}

		fire_only_once = no

		days_re_enable = 270

		days_remove = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_hire_mercenary_motorized_brigades"
			subtract_from_variable = { loot_amount = 3 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_hire_mercenary_motorized_brigades"
			custom_effect_tooltip = UDM_hire_mercenary_motorized_brigades_tt
			hidden_effect = {
				load_oob = UDM_mercs_motorized
			}
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_purchase_yugran_guarantee = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2

		visible = {
			has_country_flag = UDM_CAN_INVEST_IN_YUGRA
		}

		fire_only_once = yes

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_purchase_yugran_guarantee"
			subtract_from_variable = { loot_amount = 2 }
			KOM = {
				country_event = {
					id = UDM.14
					days = 1
				}
			}
		}
		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_expand_industrial_base = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2


		fire_only_once = no

		days_re_enable = 120

		days_remove = 30

		fixed_random_seed = no

		complete_effect = {
			subtract_from_variable = { loot_amount = 2 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision remove UDM_expand_industrial_base"
			random_list = {
				30 = {
					add_offsite_building = {
						type = industrial_complex
						level = 1
					}
				}
				30 = {
					random_owned_controlled_state = {
						add_building_construction = {
							type = industrial_complex
							level = 1
							instant_build = yes
						}
					}
				}
				20 = {
					add_offsite_building = {
						type = arms_factory
						level = 1
					}
				}
				20 = {
					random_owned_controlled_state = {
						add_building_construction = {
							type = arms_factory
							level = 1
							instant_build = yes
						}
					}
				}
			}
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_invest_in_weapons_r_and_d = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 0 }
		}

		custom_cost_text = decision_cost_loot_1

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_invest_in_r_and_d"
			add_tech_bonus = {
				bonus = 1
				uses = 1
				category = infantry_weapons
			}
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_invest_in_culture = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 0 }
		}

		custom_cost_text = decision_cost_loot_1

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_invest_in_culture"
			add_stability = 0.025
			add_political_power = 50
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_invest_in_worker_training = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 2 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_invest_in_worker_training"
			TNO_improve_industrial_expertise_low = yes
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_invest_in_industrial_equipment = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 2 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_invest_in_industrial_equipment"
			TNO_improve_industrial_equipment_low = yes
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_invest_in_education = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 2 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_invest_in_education"
			TNO_improve_academic_base_low = yes
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_invest_in_general_research = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 2 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_invest_in_general_research"
			TNO_improve_research_facilities_low = yes
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_invest_in_agriculture = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 1 }
		}

		custom_cost_text = decision_cost_loot_2

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 2 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_invest_in_agriculture"
			TNO_improve_agriculture_low = yes
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}
}

UDM_Defense_And_Influence = {
	UDM_expand_anti_air = {

		icon = decision_black_market_money

		custom_cost_trigger = {
			check_variable = { loot_amount > 0 }
		}

		custom_cost_text = decision_cost_loot_1

		fire_only_once = no

		days_re_enable = 60

		days_remove = 30

		complete_effect = {
			subtract_from_variable = { loot_amount = 1 }
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_expand_anti_air"
			random_owned_controlled_state = {
				add_building_construction = {
					type = anti_air_building
					level = 1
					instant_build = yes
				}
			}
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_send_mercenary_support = {

		icon = decision_black_market_money

		visible = {
			FROM = {
				has_war = yes
			}
			has_idea = UDM_warlord_interventions
		}

		target_array = global.russian_warlords
		target_trigger = {
			FROM = {
				is_west_siberian_nation = yes
				has_war = yes
				has_country_flag = is_warlord
				is_wasteland = no
				NOT = {
					tag = UDM
				}
				NOT = {
					any_enemy_country = {
						has_country_flag = UDM_SUPPORTED
					}
				}
			}
		}

		fire_only_once = no

		days_re_enable = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_send_mercenary_support"
			custom_effect_tooltip = UDM_send_mercenary_support_tt
			FROM = {
				set_country_flag = UDM_SUPPORTED
			}
			FROM = {
				country_event = {
					id = UDM.11
					days = 1
				}
			}
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_send_armaments = {

		icon = decision_black_market_money

		visible = {
			FROM = {
				has_war = yes
			}
		}

		target_array = global.russian_warlords
		target_trigger = {
			FROM = {
				is_west_siberian_nation = yes
				has_war = yes
				has_country_flag = is_warlord
				is_wasteland = no
				NOT = {
					tag = UDM
				}
			}
		}

		fire_only_once = no

		days_re_enable = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_send_armaments"
			FROM = {
				country_event = {
					id = UDM.12
					days = 1
				}
			}
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}

	UDM_send_advisors = {

		icon = decision_black_market_money

		visible = {
			FROM = {
				has_war = yes
			}
		}

		target_array = global.russian_warlords
		target_trigger = {
			FROM = {
				is_west_siberian_nation = yes
				has_war = yes
				has_country_flag = is_warlord
				is_wasteland = no
				NOT = {
					tag = UDM
				}
			}
		}

		fire_only_once = no

		days_re_enable = 30

		complete_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_send_mercenary_support"
			FROM = {
				country_event = {
					id = UDM.13
					days = 1
				}
			}
		}

		remove_effect = {
			log = "[GetDateText]: [Root.GetName]: Decision UDM_send_mercenary_support"
		}

		cost = 15

		ai_will_do = {
			base = 1
		}
	}
}
